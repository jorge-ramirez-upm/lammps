# Big colloid particles and small LJ particles

units		lj
atom_style	atomic
dimension	2

variable D equal 0.6 # Densidad
variable L equal 64

variable N equal round($L*$L/10)
variable p equal 0.5

# The following variables are read from the command line
#variable P equal 0.5 # Pressure
#variable T equal 0.1 # Temperature
#variable E equal 0.1 # Interaction energy A-B

log LJ_AB_GC_T$T_P$P_E$E_p$p.log

lattice		sq $D # Densidad
region		box block 0 $L 0 $L -0.5 0.5
create_box	2 box
create_atoms	1 box

set		group all type/fraction 2 $p 23984

mass 1 1.0
mass 2 1.0

group one type 1

velocity	all create $T 87287 loop geom # Temperatura

# multi neighbor and comm for efficiency

neighbor	1 multi
neigh_modify	delay 0
comm_modify     mode multi

# colloid potential

pair_style	lj/cut 2.5
pair_coeff	1 1  1.0 1.0 
pair_coeff	1 2  $E 1.0 
pair_coeff	2 2  1.0 1.0 
pair_modify shift yes

fix		1 all npt temp $T $T 1.0 iso $P $P 1.0 
fix		2 all enforce2d

fix SGMC all atom/swap 1000 $N 943984 $T types 1 2

dump		1 all atom 1000 LJ_AB_GC_T$T_P$P_E$E_p$p.lammpstrj 
dump_modify 1 sort id flush yes

compute cc1 all chunk/atom type
compute myChunk1 all property/chunk cc1 count

# HISTOGRAM STUFF
variable M equal 10 # Number of bins in x and w direction
variable N2 equal $M*$M
variable dx equal 1.0/$M
compute BINS all chunk/atom bin/2d x lower ${dx} y lower ${dx} nchunk every units reduced
compute NUM all property/chunk BINS count
variable VBIN equal vol/${N2} # Volume of each chunk
variable PHI vector c_NUM/v_VBIN
fix fPHI all ave/histo 1000 100 100000 0 1 50 v_PHI mode vector file LJ_AB_GC_T$T_P$P_E$E_p$p.histALL

#HISTOGRAM SPECIES ONE
#compute BINS1 one chunk/atom bin/2d x lower ${dx} y lower ${dx} nchunk every units reduced
compute NUM1 one property/chunk BINS count
variable PHI1 vector c_NUM1/v_VBIN
fix fPHI1 one ave/histo 1000 100 100000 0 1 50 v_PHI1 mode vector file LJ_AB_GC_T$T_P$P_E$E_p$p.histONE

variable x1 vector c_NUM1/c_NUM
fix fPHI2 one ave/histo 1000 100 100000 0 1 50 v_x1 mode vector file LJ_AB_GC_T$T_P$P_E$E_p$p.histX

thermo_style	custom step temp epair etotal press vol c_myChunk1[1] c_myChunk1[2] c_NUM[1] v_PHI[1] c_NUM1[1] v_PHI1[1] 
thermo		1000

timestep	0.01

run		1000000

