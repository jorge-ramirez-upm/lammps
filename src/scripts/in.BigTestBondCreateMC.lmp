# HOW TO RUN:
# lmp.exe -v F [DAT FILE WITHOUT equilibrated.dat] -i [LAMMPS SCRIPT] -v M [# matrix chains]
# lmp.exe -v F .\Tr4_200_10_8N1000NC9rho0.85 -i .\in.production.rod.springs -v M 9

echo            none

units           lj
atom_style      bond
special_bonds   fene angle no dihedral no

variable T equal 1.0

boundary        p p p

log $F.equilibration.log
print       "*****************************************************"
print       "Reading Configuration file... $F.lammpsdat"
print       "*****************************************************"
read_data       $F.lammpsdat extra/bond/per/atom 10	extra/special/per/atom 10

neighbor        0.6 bin
neigh_modify    every 1 delay 1 check yes
comm_modify     vel yes

bond_style      fene
bond_coeff      1 30.0 1.5 1.0 1.0  # Original Kremer-Grest
bond_coeff      2 30.0 1.5 1.0 1.0  # Original Kremer-Grest

print           ""
print       "*****************************************************"
print       "PRODUCTION: Full LJ (WCA) potential, t=1e9 tau"
print       "*****************************************************"
pair_style lj/cut 1.122462048 
pair_modify     shift yes
pair_coeff  * * 1.0 1.0 1.122462048

comm_modify cutoff 4.0

fix 1 all nve
fix 2 all langevin $T $T 2.0 48279 zero yes # Remove box COM motion by random force
timestep        0.005


#fix 3 all bond/create 100 2 2 1.0 2 prob 1.0 45984 iparam 1 1 jparam 1 1
#fix 4 all bond/break 100 2 0.9 prob 0.001 858498
#fix 3 all bond/create/destroy 100 2 2 1.0 2 
#fix BondCreate all bond/create/destroy 100     2     2    1.0    2    prob 1.0 0.001 44394398 imax 1 jmax 1 Rmin 0.0

fix 3 all bond/create/MC 100 2 2 1.0 2 energies 0.0 0.0 $T 438493 FENE 30.0 1.5 LJ 1.0 1.0 iparam 1 2 jparam 1 2
fix 4 all bond/break/MC 100 2 0.95 1.1 energies 0.0 6.0 $T 43874837 FENE 30.0 1.5 LJ 1.0 1.0 

thermo 100
thermo_style custom step temp ebond epair etotal press bonds 
thermo_modify norm no flush yes
dump            coord all custom 200 $F.TestBreakMC.lammpstrj id x y z
dump_modify coord sort id 

#restart 600000 $F.restart1.dat $F.restart2.dat

run 200000
write_data $F.TestBreakMC.lammpsdat nocoeff
